ft_sales:
deliverydaysdiff = LOOKUPVALUE('public ft_orders'[expecteddeliverydays], 'public ft_orders'[orderid], 'public ft_sales'[orderid]) - 'public ft_sales'[deliverydays]

expecteddeliverydays = MAXX(FILTER('public ft_orders', 'public ft_orders'[orderid] = 'public ft_sales'[orderid]), 'public ft_orders'[expecteddeliverydays])



---
select * from ft_sales;
select * from ft_orders


select count(dim_stockitem.stockitemid) as counter from dim_stockitem
INNER JOIN ft_sales on dim_stockitem.stockitemid = ft_sales.stockitemid
group by dim_stockitem.stockitemname
ORDER BY counter DESC

select * from dim_stockitem where stockitemname = 'Alien officer hoodie (Black) 3XL'

select count (orderid) from ft_sales
where stockitemid = 104

select * from dim_date


select sum(lineprofit) as totalprofit from ft_sales
inner join dim_date on dim_date.date_day = ft_sales.invoicedate
where dim_date.year_actual = 2019



----